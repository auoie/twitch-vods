datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model streams {
  id                                    String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  streamer_id                           String
  stream_id                             String
  start_time                            DateTime
  max_views                             BigInt
  last_updated_at                       DateTime
  streamer_login_at_start               String
  language_at_start                     String
  title_at_start                        String
  game_name_at_start                    String
  game_id_at_start                      String
  is_mature_at_start                    Boolean
  last_updated_minus_start_time_seconds Float

  recording_fetched_at DateTime?
  gzipped_bytes        Bytes?
  hls_domain           String?
  hls_duration_seconds Float?
  bytes_found          Boolean?
  public               Boolean?
  sub_only             Boolean?
  seek_previews_domain String?

  @@unique([stream_id, start_time])

  @@index([streamer_id, start_time(sort: Desc)])
  @@index([streamer_login_at_start, start_time(sort: Desc)])
  @@index([start_time(sort: Desc)])

  @@index([bytes_found, recording_fetched_at, id])

  @@index([max_views(sort: Desc)])
  @@index([bytes_found, max_views(sort: Desc)])
  @@index([sub_only, max_views(sort: Desc)])
  @@index([language_at_start, max_views(sort: Desc)])
  @@index([bytes_found, language_at_start, max_views(sort: Desc)])
  @@index([sub_only, bytes_found, max_views(sort: Desc)])
  @@index([sub_only, language_at_start, max_views(sort: Desc)])
  @@index([sub_only, bytes_found, language_at_start, max_views(sort: Desc)])
}
