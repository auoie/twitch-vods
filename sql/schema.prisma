datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model streams {
  id                      String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  streamer_id             String
  stream_id               String      @unique
  start_time              DateTime
  max_views               BigInt
  last_updated_at         DateTime
  streamer_login_at_start String
  recordings              recordings?

  @@index([streamer_id, start_time(sort: Desc)])
}

model recordings {
  id                   String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  stream_id            String   @unique
  fetched_at           DateTime
  gzipped_bytes        Bytes?
  hls_domain           String?
  bytes_found          Boolean
  public               Boolean?
  sub_only             Boolean?
  seek_previews_domain String?

  stream streams @relation(fields: [stream_id], references: [stream_id], onDelete: Cascade, onUpdate: Cascade)

  @@index([bytes_found])
}
